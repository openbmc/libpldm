{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f980af62_34b906c7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-06-17T00:07:40Z",
      "side": 1,
      "message": "Hi Varsha,\n\nIf we\u0027re changing the public API of the library then I\u0027d very much prefer we add an entry to the changelog. Working through the checklist at https://github.com/openbmc/libpldm/blob/main/docs/checklists/changes.md will help make sure everything necessary is covered off.\n\nBeyond that, I\u0027ve commented on some concerns inline.",
      "revId": "c2d0c011dd880d236bdab095e7dbfed32cfca81c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8967b9f3_fde8c9cc",
        "filename": "include/libpldm/pdr.h",
        "patchSetId": 1
      },
      "lineNbr": 283,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-06-17T00:07:40Z",
      "side": 1,
      "message": "Should we be using \"FRU\" here? Why not PDR? If it is a FRU type in the formal (DSP0257?) sense, is there a reason \"fru\" is not in the type names?\n\nThis query probably extends beyond the scope of the patch, but I wonder if there\u0027s a missed opportunity for more tightly constraining the types.",
      "range": {
        "startLine": 283,
        "startChar": 21,
        "endLine": 283,
        "endChar": 24
      },
      "revId": "c2d0c011dd880d236bdab095e7dbfed32cfca81c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5ab8add6_1f762647",
        "filename": "include/libpldm/pdr.h",
        "patchSetId": 1
      },
      "lineNbr": 289,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-06-17T00:07:40Z",
      "side": 1,
      "message": "In the same vein, do we expect to be allocating in the remove path?",
      "range": {
        "startLine": 288,
        "startChar": 65,
        "endLine": 289,
        "endChar": 21
      },
      "revId": "c2d0c011dd880d236bdab095e7dbfed32cfca81c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7005871_6254fdcd",
        "filename": "include/libpldm/pdr.h",
        "patchSetId": 1
      },
      "lineNbr": 289,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-06-17T00:07:40Z",
      "side": 1,
      "message": "I don\u0027t think this should be a problem for _removing_ a record?",
      "range": {
        "startLine": 289,
        "startChar": 21,
        "endLine": 289,
        "endChar": 77
      },
      "revId": "c2d0c011dd880d236bdab095e7dbfed32cfca81c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "961fabab_d4300627",
        "filename": "src/dsp/pdr.c",
        "patchSetId": 1
      },
      "lineNbr": 310,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-06-17T00:07:40Z",
      "side": 1,
      "message": "I think it would be more ergonomic with the signature\n\n```\nstatic pldm_pdr_record *pldm_pdr_get_prev_record(const pldm_pdr *repo,\n    const pldm_pdr_record *record);\n```\n\nThat way we just return the previous record (or `NULL`) directly.",
      "range": {
        "startLine": 309,
        "startChar": 0,
        "endLine": 310,
        "endChar": 32
      },
      "revId": "c2d0c011dd880d236bdab095e7dbfed32cfca81c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "699e1110_e5513315",
        "filename": "src/dsp/pdr.c",
        "patchSetId": 1
      },
      "lineNbr": 331,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-06-17T00:07:40Z",
      "side": 1,
      "message": "Can we add `assert(repo-\u003esize \u003e\u003d record-\u003esize)` _above_ (in addition to) this check?",
      "revId": "c2d0c011dd880d236bdab095e7dbfed32cfca81c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c7881490_431d640d",
        "filename": "src/dsp/pdr.c",
        "patchSetId": 1
      },
      "lineNbr": 349,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-06-17T00:07:40Z",
      "side": 1,
      "message": "We really must only do this if we know we\u0027ve removed the record. For instance, what if we try to remove the same record twice? This obviously isn\u0027t a sensible thing to do when so directly stated, but that doesn\u0027t mean that there won\u0027t be some other bug in the calling applications that causes the condition.\n\nSo we need to know the record actually exists in the repo first. The hints we have that it is not are that `pldm_pdr_get_prev_record()` returns `NULL`, and that `record` is neither the first nor last in the repo.\n\nWithout ensuring that it\u0027s actually part of the repo we will corrupt the repo size and cause an error that has a large separation in time from the failure.",
      "revId": "c2d0c011dd880d236bdab095e7dbfed32cfca81c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6ee88dc_54c218fe",
        "filename": "tests/dsp/pdr.cpp",
        "patchSetId": 1
      },
      "lineNbr": 748,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-06-17T00:07:40Z",
      "side": 1,
      "message": "In addition, we need to test that the other two records are still present.",
      "revId": "c2d0c011dd880d236bdab095e7dbfed32cfca81c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d3f2e855_599d54d4",
        "filename": "tests/dsp/pdr.cpp",
        "patchSetId": 1
      },
      "lineNbr": 750,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-06-17T00:07:40Z",
      "side": 1,
      "message": "Please also test other conditions like trying to remove the same record twice, followed by removing all records successfully.",
      "revId": "c2d0c011dd880d236bdab095e7dbfed32cfca81c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}